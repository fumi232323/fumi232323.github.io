<!DOCTYPE html>
<html lang="ja-JP">

  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0">
    <title>Django: Template/32imuf.com</title>
    <link rel="shortcut icon" href="/static/icons/favicon.ico">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Griffy">
    <link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Vollkorn:400,700">
    <link rel="stylesheet" href="https://fonts.googleapis.com/earlyaccess/sawarabimincho.css"/>
    <link rel="stylesheet" href="https://use.fontawesome.com/releases/v5.0.13/css/all.css" integrity="sha384-DNOHZ68U8hZfKXOrtjWvjxusGo9WQnrNx2sqG0tfsghAvtVlRW3tvkXWZh58N9jp" crossorigin="anonymous">
    <link rel="stylesheet" href="/static/css/style.css?20190506">
  </head>

  <body>
    <div class="container">
      <div class="header"><header class="item item-header">
  <h1>
    <a href="/">
      <img class="logo" src="/static/images/inuu.png" alt="犬">
    </a>
  </h1>
  <nav class="nav">
    <ul>
      <li class="nav-category"><a href="/">HOME</a></li>
      
      
        
        <li class="nav-category">
          <a href="/index_category_category_aws.html">aws</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../aws/what-is-amazon-aurora/">Amazon Aurora とはなんですか？</a>
              </li>
            
              <li class="nav-article">
                <a href="../../aws/s3-response-error/">S3ResponseError の原因はなんと時刻ずれだった</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_blog.html">blog</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../blog/rules/">ブログを書くときの注意点</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_css.html">css</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../html-css/css/note/">CSS のメモ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../html-css/configure-stylus-output-directory/">PyCharm の File Watcher で、 Stylus の CSS ファイル生成先ディレクトリを指定する。</a>
              </li>
            
              <li class="nav-article">
                <a href="../../html-css/stylus/">Stylus を使う</a>
              </li>
            
              <li class="nav-article">
                <a href="../../html-css/html5-css3-modern-coding/">『HTML5/CSS3モダンコーディング フロントエンドエンジニアが教える3つの本格レイアウト スタンダード・グリッド・シングルページレイアウトの作り方』を読んで気になったことメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_django.html">django</a>
          <ul>
            
              <li class="nav-article">
                <a href="../manage/">Django: django-admin.py, manage.py</a>
              </li>
            
              <li class="nav-article">
                <a href="./">Django: Template</a>
              </li>
            
              <li class="nav-article">
                <a href="../view/">Django: View</a>
              </li>
            
              <li class="nav-article">
                <a href="../urlconf/">Django: URL ディスパッチャ, URLconf</a>
              </li>
            
              <li class="nav-article">
                <a href="../model/">Django: Model, Django ORM</a>
              </li>
            
              <li class="nav-article">
                <a href="../note/">Django なんでもメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_docker.html">docker</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../docker/create-django-env-with-docker-compose-2/">Docker Compose で Django 環境をつくろう その2</a>
              </li>
            
              <li class="nav-article">
                <a href="../../docker/connect-from-sqla-to-mysqldb/">Docker Compose で MySQL DB をつくり Compose 外 (非 docker) の SQLAlchemy から接続する</a>
              </li>
            
              <li class="nav-article">
                <a href="../../docker/create-django-env-with-docker-compose-mysql-2/">Docker Compose で Django/MySQL 環境をつくる その2</a>
              </li>
            
              <li class="nav-article">
                <a href="../../docker/create-django-env-with-docker-compose-mysql/">Docker Compose で Django/MySQL 環境をつくる</a>
              </li>
            
              <li class="nav-article">
                <a href="../../docker/use-volumes-with-docker-compose/">Docker Compose で Volumes をつかう</a>
              </li>
            
              <li class="nav-article">
                <a href="../../docker/create-django-env-with-docker-compose/">Docker Compose で Django/PostgreSQL 環境をつくる</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_git.html">git</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../git/command/merge/">git merge</a>
              </li>
            
              <li class="nav-article">
                <a href="../../git/command/rebase-i/">git rebase -i</a>
              </li>
            
              <li class="nav-article">
                <a href="../../git/command/rebase/">git rebase</a>
              </li>
            
              <li class="nav-article">
                <a href="../../git/note/">Git のメモ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../git/configuration/">Git の設定まとめ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../git/command/">Git のコマンドまとめ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_github.html">github</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../github/how-to-create-new-repository/">GitHub に新しいリポジトリを作成して、pushする</a>
              </li>
            
              <li class="nav-article">
                <a href="../../github/github-pages-custom-domain-setting/">GitHub Pages にカスタムドメインを設定する</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_mac.html">mac</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../mac/note/">Mac のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_miyadaiku.html">miyadaiku</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../miyadaiku/build/">Miyadaiku ビルドするときのコマンド</a>
              </li>
            
              <li class="nav-article">
                <a href="../../miyadaiku/article-directory-structure/">article の置きかた</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_mysql.html">mysql</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../mysql/note/">MySQL のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_pycharm.html">pycharm</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../pycharm/django-support/">Pycharm の Django support を使う</a>
              </li>
            
              <li class="nav-article">
                <a href="../../pycharm/add-psql-var-to-user-params-for-db-console/">PyCharm の Database Console で PostgreSQL のプレースホルダー (インタポレーション) を SQL パラメーターとして使えるようにする</a>
              </li>
            
              <li class="nav-article">
                <a href="../../pycharm/connect-db-using-ssh-tunnel/">PyCharm で SSH tunnel して Amazon Redshift につなぐ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../pycharm/useful-menu-and-shortcuts/">PyCharm ショートカットと便利メニュー</a>
              </li>
            
              <li class="nav-article">
                <a href="../../pycharm/configuration/">PyCharm の設定</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_python.html">python</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../python/note/">Python のメモ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../python/etc/">Python いろいろメモ</a>
              </li>
            
              <li class="nav-article">
                <a href="../../python/pyconjp2018/">PyConJP 2018 で聞いた講演</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_redshift.html">redshift</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../redshift/note/">Redshift のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_sample.html">sample</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../2018/sample-table/">table の sample</a>
              </li>
            
              <li class="nav-article">
                <a href="../../2018/sample-h1-h2-h3-li/">h1, h2, h3, リストの sample</a>
              </li>
            
              <li class="nav-article">
                <a href="../../2018/sample-code-block/">code-block, 引用の sample</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_sql.html">sql</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../sql/note/">SQL のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_sqlalchemy.html">sqlalchemy</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../sqlalchemy/note/">SQLAlchemy メモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_ssh.html">ssh</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../ssh/command/ssh-keygen/">ssh-keygen</a>
              </li>
            
              <li class="nav-article">
                <a href="../../ssh/command/ssh-add/">ssh-add</a>
              </li>
            
              <li class="nav-article">
                <a href="../../ssh/command/ssh/">ssh のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_test.html">test</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../python-test/tox/">tox</a>
              </li>
            
              <li class="nav-article">
                <a href="../../python-test/mypy/">mypy</a>
              </li>
            
              <li class="nav-article">
                <a href="../../python-test/note/">Python テストのメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_vagrant.html">vagrant</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../vagrant/note/">Vagrant のメモ</a>
              </li>
            
          </ul>
        </li>
      
        
        <li class="nav-category">
          <a href="/index_category_category_vim.html">vim</a>
          <ul>
            
              <li class="nav-article">
                <a href="../../vim/command/">Vim のコマンド</a>
              </li>
            
          </ul>
        </li>
      
    </ul>
  </nav>
</header></div>
      <div class="main">
<div class="article-content">
  <main class="item item-article item-django">
    <time class="date" datetime="2019-05-06 00:00:00+09:00">
      2019-05-06 Mon
    </time>
    <div class="title">Django: Template</div>
    <div class="category">
      <a href="/index_category_category_django.html">
          django
      </a>
    </div>
    <div class="text">
      <details>
<summary>目次</summary><div class="contents topic" id="contents">
<p class="topic-title first">Contents</p>
<ul class="simple">
<li><p><a class="reference internal" href="#id1" id="id21">リファレンス/書籍</a></p></li>
<li><p><a class="reference internal" href="#id3" id="id22">なるほどめも</a></p></li>
<li><p><a class="reference internal" href="#id4" id="id23">変数表示</a></p></li>
<li><p><a class="reference internal" href="#id5" id="id24">フィルタ</a></p>
<ul>
<li><p><a class="reference internal" href="#id6" id="id25">デフォルト表示</a></p></li>
<li><p><a class="reference internal" href="#id7" id="id26">文字列長を表示</a></p></li>
<li><p><a class="reference internal" href="#id8" id="id27">エスケープの無効化</a></p></li>
<li><p><a class="reference internal" href="#id9" id="id28">日時フォーマット</a></p></li>
<li><p><a class="reference internal" href="#id10" id="id29">改行タグの変換</a></p></li>
<li><p><a class="reference internal" href="#id11" id="id30">リンク変換</a></p></li>
<li><p><a class="reference internal" href="#id12" id="id31">文字の切り詰め</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id13" id="id32">テンプレートタグ</a></p>
<ul>
<li><p><a class="reference internal" href="#if" id="id33">if</a></p></li>
<li><p><a class="reference internal" href="#for" id="id34">for</a></p></li>
<li><p><a class="reference internal" href="#id14" id="id35">テンプレートの継承</a></p></li>
<li><p><a class="reference internal" href="#id15" id="id36">外部テンプレートの読み込み</a></p></li>
<li><p><a class="reference internal" href="#url" id="id37">静的ファイルの配信 URL 取得</a></p></li>
<li><p><a class="reference internal" href="#id16" id="id38">url</a></p></li>
<li><p><a class="reference internal" href="#id17" id="id39">自動エスケープ制御</a></p></li>
</ul>
</li>
<li><p><a class="reference internal" href="#id18" id="id40">ベーステンプレートを用意しよう</a></p></li>
<li><p><a class="reference internal" href="#id19" id="id41">独自のテンプレートタグとフィルタ</a></p></li>
</ul>
</div>
</details><div class="section" id="id1">
<div class="md_header_block" id="h_%E3%83%AA%E3%83%95%E3%82%A1%E3%83%AC%E3%83%B3%E3%82%B9%E6%9B%B8%E7%B1%8D"><a class="md_header_anchor" id="a_%E3%83%AA%E3%83%95%E3%82%A1%E3%83%AC%E3%83%B3%E3%82%B9%E6%9B%B8%E7%B1%8D"></a><h1><a class="toc-backref" href="#id21">リファレンス/書籍</a></h1></div>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.djangoproject.com/ja/2.2/topics/templates/">Django documentation &gt; テンプレート</a></p></li>
<li><p><a class="reference external" href="https://docs.djangoproject.com/ja/2.2/ref/templates/builtins/">Django documentation &gt; 組み込みタグとフィルタ</a></p></li>
<li><p><a class="reference external" href="https://www.amazon.co.jp/dp/B07GK7BWB7/">現場で使える Django の教科書</a></p></li>
</ul>
</div>
<div class="section" id="id3">
<div class="md_header_block" id="h_%E3%81%AA%E3%82%8B%E3%81%BB%E3%81%A9%E3%82%81%E3%82%82"><a class="md_header_anchor" id="a_%E3%81%AA%E3%82%8B%E3%81%BB%E3%81%A9%E3%82%81%E3%82%82"></a><h1><a class="toc-backref" href="#id22">なるほどめも</a></h1></div>
<ul class="simple">
<li><p>変数定義できない</p></li>
<li><p>Python モジュールを直接 import して使うことはできない</p>
<ul>
<li><p>独自の関数を使うにはテンプレートタグやフィルタを自作する</p></li>
</ul>
</li>
<li><p>フィルター: 変数の内容を表示する際の表示形式を変更する</p></li>
</ul>
</div>
<div class="section" id="id4">
<div class="md_header_block" id="h_%E5%A4%89%E6%95%B0%E8%A1%A8%E7%A4%BA"><a class="md_header_anchor" id="a_%E5%A4%89%E6%95%B0%E8%A1%A8%E7%A4%BA"></a><h1><a class="toc-backref" href="#id23">変数表示</a></h1></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="c">{# __str__() の結果を表示してくれる #}</span><span class="x"></span>
<span class="cp">{{</span> <span class="nv">user</span> <span class="cp">}}</span><span class="x"></span>

<span class="c">{# このように書くと #}</span><span class="x"></span>
<span class="cp">{{</span> <span class="nv">user.username</span> <span class="cp">}}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">comment</span> <span class="s2">"以下の順番に値を取得しようとして、一番先に取得できた値を表示してくれる"</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  user['username']  # 1. 辞書としての照合</span>
<span class="x">  user.username     # 2. 属性値の照合</span>
<span class="x">  user.username()   # 3. メソッド呼び出し</span>
<span class="x">  user[username]    # 4. リストやタプルの添字指定</span>
<span class="cp">{%</span> <span class="k">endcomment</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>テンプレートには「コンテキスト」と呼ばれる変数と値がマッピングされたオブジェクトが渡される</p>
<ul>
<li><p>コンテキストに含まれるもの</p>
<ul>
<li><p>ビューから渡された変数</p></li>
<li><p><span class="docutils literal">settings.py</span> の <span class="docutils literal">TEMPLATES.OPTIONS.context_processors</span> に定義された関数でセットされた変数</p>
<ul>
<li><p><span class="docutils literal">request</span>: リクエストオブジェクト</p></li>
<li><p><span class="docutils literal">user</span>: ユーザー</p></li>
<li><p><span class="docutils literal">perms</span>: ユーザーのパーミッション</p></li>
<li><p><span class="docutils literal">messages</span>: フラッシュメッセージ</p></li>
<li><p>e.t.c...</p></li>
</ul>
</li>
</ul>
</li>
</ul>
</li>
<li><p>何もしなくも XSS 対策として <span class="docutils literal">&lt;</span>, <span class="docutils literal">&gt;</span>, <span class="docutils literal">'</span>, <span class="docutils literal">"</span>, <span class="docutils literal">&amp;</span> を自動でエスケープしてくれる</p></li>
</ul>
</div>
<div class="section" id="id5">
<div class="md_header_block" id="h_%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF"><a class="md_header_anchor" id="a_%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF"></a><h1><a class="toc-backref" href="#id24">フィルタ</a></h1></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="c">{# 変数名の直後に ``|`` (パイプ) を使って繋げる #}</span><span class="x"></span>
<span class="cp">{{</span> <span class="o">&lt;</span><span class="err">変数名</span><span class="o">&gt;</span><span class="err">|</span><span class="o">&lt;</span><span class="err">フィルタ名</span><span class="o">&gt;</span> <span class="cp">}}</span><span class="x"></span>

<span class="c">{# フィルタによっては引数もとれる、 ``:`` で繋げる #}</span><span class="x"></span>
<span class="cp">{{</span> <span class="o">&lt;</span><span class="err">変数名</span><span class="o">&gt;</span><span class="err">|</span><span class="o">&lt;</span><span class="err">フィルタ名</span><span class="o">&gt;</span><span class="s2">:"&lt;引数&gt;"</span> <span class="cp">}}</span><span class="x"></span>

<span class="c">{# フィルタは ``|`` で連結できる #}</span><span class="x"></span>
<span class="cp">{{</span> <span class="o">&lt;</span><span class="err">変数名</span><span class="o">&gt;</span><span class="err">|</span><span class="o">&lt;</span><span class="err">フィルタ名</span><span class="m">1</span><span class="o">&gt;</span><span class="s2">:"&lt;引数&gt;"</span><span class="err">|</span><span class="o">&lt;</span><span class="err">フィルタ名</span><span class="m">2</span><span class="o">&gt;</span><span class="s2">:"&lt;引数&gt;"</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<div class="section" id="id6">
<div class="md_header_block" id="h_%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E8%A1%A8%E7%A4%BA"><a class="md_header_anchor" id="a_%E3%83%87%E3%83%95%E3%82%A9%E3%83%AB%E3%83%88%E8%A1%A8%E7%A4%BA"></a><h2><a class="toc-backref" href="#id25">デフォルト表示</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">user.first_name</span><span class="o">|</span><span class="nf">default</span><span class="s2">:""</span> <span class="cp">}}</span><span class="x"> </span><span class="cp">{{</span> <span class="nv">user.first_name</span><span class="o">|</span><span class="nf">default</span><span class="s2">:""</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>変数が存在しない場合、あるいは変数の値が <span class="docutils literal">None</span>, <span class="docutils literal">''</span>, <span class="docutils literal">0</span>, <span class="docutils literal">False</span>, <span class="docutils literal">[]</span> などの場合に指定した文字列を表示する</p></li>
</ul>
</div>
<div class="section" id="id7">
<div class="md_header_block" id="h_%E6%96%87%E5%AD%97%E5%88%97%E9%95%B7%E3%82%92%E8%A1%A8%E7%A4%BA"><a class="md_header_anchor" id="a_%E6%96%87%E5%AD%97%E5%88%97%E9%95%B7%E3%82%92%E8%A1%A8%E7%A4%BA"></a><h2><a class="toc-backref" href="#id26">文字列長を表示</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">user.username</span><span class="o">|</span><span class="nf">length</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="id8">
<div class="md_header_block" id="h_%E3%82%A8%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96"><a class="md_header_anchor" id="a_%E3%82%A8%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%97%E3%81%AE%E7%84%A1%E5%8A%B9%E5%8C%96"></a><h2><a class="toc-backref" href="#id27">エスケープの無効化</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">book.description</span><span class="o">|</span><span class="nf">safe</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>XSS 対策として自動でエスケープしてくれる <span class="docutils literal">&lt;</span>, <span class="docutils literal">&gt;</span>, <span class="docutils literal">'</span>, <span class="docutils literal">"</span>, <span class="docutils literal">&amp;</span> をエスケープしない</p></li>
<li><p>変数の内容が安全だとわかっている場合のみ利用すること</p></li>
</ul>
</div>
<div class="section" id="id9">
<div class="md_header_block" id="h_%E6%97%A5%E6%99%82%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88"><a class="md_header_anchor" id="a_%E6%97%A5%E6%99%82%E3%83%95%E3%82%A9%E3%83%BC%E3%83%9E%E3%83%83%E3%83%88"></a><h2><a class="toc-backref" href="#id28">日時フォーマット</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">user.last_login</span><span class="o">|</span><span class="nf">date</span><span class="s2">:"Y-m-d H:i:s"</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="id10">
<div class="md_header_block" id="h_%E6%94%B9%E8%A1%8C%E3%82%BF%E3%82%B0%E3%81%AE%E5%A4%89%E6%8F%9B"><a class="md_header_anchor" id="a_%E6%94%B9%E8%A1%8C%E3%82%BF%E3%82%B0%E3%81%AE%E5%A4%89%E6%8F%9B"></a><h2><a class="toc-backref" href="#id29">改行タグの変換</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">book.description</span><span class="o">|</span><span class="nf">linebreaksbr</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p><span class="docutils literal">\n</span> を <span class="docutils literal">&lt;br&gt;</span> に変換してくれる</p></li>
<li><p>便利だな...</p></li>
</ul>
</div>
<div class="section" id="id11">
<div class="md_header_block" id="h_%E3%83%AA%E3%83%B3%E3%82%AF%E5%A4%89%E6%8F%9B"><a class="md_header_anchor" id="a_%E3%83%AA%E3%83%B3%E3%82%AF%E5%A4%89%E6%8F%9B"></a><h2><a class="toc-backref" href="#id30">リンク変換</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">book.description</span><span class="o">|</span><span class="nf">urlize</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>URL と メールアドレスの部分だけをアンカータグで囲んでクリック可能なリンクに変換してくれる</p></li>
<li><p>しゅごいな...</p></li>
</ul>
</div>
<div class="section" id="id12">
<div class="md_header_block" id="h_%E6%96%87%E5%AD%97%E3%81%AE%E5%88%87%E3%82%8A%E8%A9%B0%E3%82%81"><a class="md_header_anchor" id="a_%E6%96%87%E5%AD%97%E3%81%AE%E5%88%87%E3%82%8A%E8%A9%B0%E3%82%81"></a><h2><a class="toc-backref" href="#id31">文字の切り詰め</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{{</span> <span class="nv">book.description</span><span class="o">|</span><span class="nf">truncatechars_html</span><span class="o">:</span><span class="m">5</span> <span class="cp">}}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>指定した文字数まで切り詰めて <span class="docutils literal">...</span> をくっつけてくれる</p></li>
<li><p>HTML タグを考慮して省略後の文字にきちんと閉じタグをつけてくれる</p></li>
<li><p>うええ...</p></li>
</ul>
</div>
</div>
<div class="section" id="id13">
<div class="md_header_block" id="h_%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%BF%E3%82%B0"><a class="md_header_anchor" id="a_%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%BF%E3%82%B0"></a><h1><a class="toc-backref" href="#id32">テンプレートタグ</a></h1></div>
<div class="section" id="if">
<div class="md_header_block" id="h_if"><a class="md_header_anchor" id="a_if"></a><h2><a class="toc-backref" href="#id33">if</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">if</span> <span class="nv">user.is_superuser</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  システム管理者です。</span>
<span class="cp">{%</span> <span class="k">elif</span> <span class="nv">user.is_staff</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  スタッフです。</span>
<span class="cp">{%</span> <span class="k">else</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  一般ユーザーだよ。</span>
<span class="cp">{%</span> <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="c">{# フィルタと組み合わせることもできる #}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">if</span> <span class="nv">user.username</span><span class="o">|</span><span class="nf">length</span> <span class="o">&lt;</span> <span class="m">3</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  ユーザー名が短かすぎます。</span>
<span class="cp">{%</span>  <span class="k">endif</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="for">
<div class="md_header_block" id="h_for"><a class="md_header_anchor" id="a_for"></a><h2><a class="toc-backref" href="#id34">for</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">for</span> <span class="nv">book</span> <span class="k">in</span> <span class="nv">book_list</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nv">book.title</span> <span class="cp">}}</span><span class="x"></span>

<span class="x">  </span><span class="c">{# for ループ内で使える変数 #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.counter</span> <span class="cp">}}</span><span class="x">     </span><span class="c">{# 現在のループカウンタ番号 ( 1 から順にカウント ) #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.counter0</span> <span class="cp">}}</span><span class="x">    </span><span class="c">{# 現在のループカウンタ番号 ( 0 から順にカウント ) #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.revcounter</span> <span class="cp">}}</span><span class="x">  </span><span class="c">{# 現在のループカウンタ値 ( 1 から順に、末尾からカウント) #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.revcounter0</span> <span class="cp">}}</span><span class="x"> </span><span class="c">{# 現在のループカウンタ値 ( 0 から順に、末尾からカウント) #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.first</span> <span class="cp">}}</span><span class="x">       </span><span class="c">{# 最初のループであれば True #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.last</span> <span class="cp">}}</span><span class="x">        </span><span class="c">{# 最後のループであれば True #}</span><span class="x"></span>
<span class="x">  </span><span class="cp">{{</span> <span class="nb">forloop</span><span class="nv">.parentloop</span> <span class="cp">}}</span><span class="x">  </span><span class="c">{# 入れ子のループであるとき、現在のループを囲んでいる 1 つ上のループを表します。 #}</span><span class="x"></span>

<span class="cp">{%</span>  <span class="k">empty</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  本ない</span>
<span class="cp">{%</span>  <span class="k">endfor</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="id14">
<div class="md_header_block" id="h_%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E7%B6%99%E6%89%BF"><a class="md_header_anchor" id="a_%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E7%B6%99%E6%89%BF"></a><h2><a class="toc-backref" href="#id35">テンプレートの継承</a></h2></div>
<ul>
<li><p>親テンプレート <span class="docutils literal">parent.html</span></p>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">block</span> <span class="nv">sample</span> <span class="cp">%}</span><span class="x">Hello </span><span class="cp">{%</span> <span class="k">endblock</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</li>
<li><p>子テンプレート <span class="docutils literal">child.html</span></p>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">extends</span> <span class="s2">"parent.html"</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">block</span> <span class="nv">sample</span> <span class="cp">%}{{</span> <span class="nb">block</span><span class="nv">.super</span> <span class="o">}</span><span class="nv">World</span><span class="err">!</span> <span class="o">{</span><span class="err">%</span> <span class="nv">endblock</span> <span class="err">%</span><span class="o">}</span>
<span class="o">{</span><span class="err">#</span> <span class="nb">block</span><span class="nv">.super</span><span class="o">:</span> <span class="err">親テンプレートのブロック内部の値をそのまま保持した変数</span> <span class="err">#</span><span class="o">}</span>
</pre></div>
</div>
</li>
</ul>
</div>
<div class="section" id="id15">
<div class="md_header_block" id="h_%E5%A4%96%E9%83%A8%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF"><a class="md_header_anchor" id="a_%E5%A4%96%E9%83%A8%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%81%AE%E8%AA%AD%E3%81%BF%E8%BE%BC%E3%81%BF"></a><h2><a class="toc-backref" href="#id36">外部テンプレートの読み込み</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">include</span> <span class="s2">"_message.html"</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>ヘッダーフッターなど部品化したテンプレートを別のテンプレートから読み込む場合など</p></li>
</ul>
</div>
<div class="section" id="url">
<div class="md_header_block" id="h_%E9%9D%99%E7%9A%84%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E9%85%8D%E4%BF%A1URL%E5%8F%96%E5%BE%97"><a class="md_header_anchor" id="a_%E9%9D%99%E7%9A%84%E3%83%95%E3%82%A1%E3%82%A4%E3%83%AB%E3%81%AE%E9%85%8D%E4%BF%A1URL%E5%8F%96%E5%BE%97"></a><h2><a class="toc-backref" href="#id37">静的ファイルの配信 URL 取得</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="c">{# 利用する前に機能をロードしておく #}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">load</span> <span class="nv">static</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">static</span> <span class="s2">"images/logo.png"</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">static</span> <span class="s2">"shop/images/no-image.png"</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
<ul class="simple">
<li><p>静的ファイルの配信 URL を取得するためのタグ</p></li>
<li><p>Django デフォルトで使える組み込みタグではないのでロードが必要</p></li>
<li><p><span class="docutils literal">extends</span> している場合、継承元で <span class="docutils literal">load</span> していても自身のテンプレートでは有効にならないので、
つど <span class="docutils literal">load</span> する必要がある</p></li>
</ul>
</div>
<div class="section" id="id16">
<div class="md_header_block" id="h_url"><a class="md_header_anchor" id="a_url"></a><h2><a class="toc-backref" href="#id38">url</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="c">{# URL 逆引き #}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">url</span> <span class="s2">"index"</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">url</span> <span class="s2">"accounts:login"</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">url</span> <span class="s2">"shop:detail"</span> <span class="nv">book.id</span> <span class="cp">%}</span><span class="x"></span>
<span class="cp">{%</span> <span class="k">url</span> <span class="s2">"shop:detail"</span> <span class="nv">book_id</span><span class="o">=</span><span class="nv">book.id</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
<div class="section" id="id17">
<div class="md_header_block" id="h_%E8%87%AA%E5%8B%95%E3%82%A8%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%97%E5%88%B6%E5%BE%A1"><a class="md_header_anchor" id="a_%E8%87%AA%E5%8B%95%E3%82%A8%E3%82%B9%E3%82%B1%E3%83%BC%E3%83%97%E5%88%B6%E5%BE%A1"></a><h2><a class="toc-backref" href="#id39">自動エスケープ制御</a></h2></div>
<div class="code-block">
<div class="highlight"><pre><span></span><span class="cp">{%</span> <span class="k">autoescape</span> <span class="nv">off</span> <span class="cp">%}</span><span class="x"></span>
<span class="x">  自動エスケープがオフになる範囲</span>
<span class="cp">{%</span> <span class="k">endautoescape</span> <span class="cp">%}</span><span class="x"></span>
</pre></div>
</div>
</div>
</div>
<div class="section" id="id18">
<div class="md_header_block" id="h_%E3%83%99%E3%83%BC%E3%82%B9%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E7%94%A8%E6%84%8F%E3%81%97%E3%82%88%E3%81%86"><a class="md_header_anchor" id="a_%E3%83%99%E3%83%BC%E3%82%B9%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%92%E7%94%A8%E6%84%8F%E3%81%97%E3%82%88%E3%81%86"></a><h1><a class="toc-backref" href="#id40">ベーステンプレートを用意しよう</a></h1></div>
<ul class="simple">
<li><p>現場で使える Django の教科書《基礎編》 P.79 参照のこと</p>
<ul>
<li><p>どのテンプレートにも書くような共通の内容は base.html テンプレートする</p></li>
</ul>
</li>
</ul>
</div>
<div class="section" id="id19">
<div class="md_header_block" id="h_%E7%8B%AC%E8%87%AA%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%BF%E3%82%B0%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF"><a class="md_header_anchor" id="a_%E7%8B%AC%E8%87%AA%E3%81%AE%E3%83%86%E3%83%B3%E3%83%97%E3%83%AC%E3%83%BC%E3%83%88%E3%82%BF%E3%82%B0%E3%81%A8%E3%83%95%E3%82%A3%E3%83%AB%E3%82%BF"></a><h1><a class="toc-backref" href="#id41">独自のテンプレートタグとフィルタ</a></h1></div>
<p>カスタムタグやカスタムフィルタをつくることができる。</p>
<ul class="simple">
<li><p><a class="reference external" href="https://docs.djangoproject.com/ja/2.2/howto/custom-template-tags/">Django documentation &gt; 独自のテンプレートタグとフィルタ</a></p></li>
</ul>
</div>
    </div>
  </main>
</div>
</div>
    </div>
  </body>

</html>